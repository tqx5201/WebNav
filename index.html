<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <!-- 头部元信息：定义文档类型、字符集、兼容模式、视口、作者、标题、关键词和描述 -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="https://dstbp.net/" />
    <title>DSTBP Navigation - 个人网址集</title>
    <meta name="keywords" content="导航页, 导航, WebNav, DSTBP, Github, Github Pages, r0xanne" />
    <meta name="description" content="一个简洁、优雅的个人网址导航页面" />
    <link rel="shortcut icon" href="./favicon.ico" />

    <!-- 样式表链接 -->
    <link rel="stylesheet" href="./css/style.min.css" />
    <link rel="stylesheet" href="./css/dark.min.css" />
    <link rel="stylesheet" href="./css/animation.min.css" />
    <link rel="stylesheet" href="./css/mobile.min.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://s1.hdslb.com/bfs/static/jinkela/long/font/regular.css" />
    <link rel="stylesheet" href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/izitoast/1.4.0/css/iziToast.min.css" />
    <link rel="stylesheet" href="./css/background.css" />

    <!-- 核心脚本 -->
    <script src="./js/lozad.min.js"></script>
    <script src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/izitoast/1.4.0/js/iziToast.min.js"></script>
    
    <!-- 社交媒体/分享预览元信息 -->
    <meta property="og:type" content="article" />
    <meta property="og:title" content="DSTBP - WebNav" />
    <meta property="og:description" content="个人网址集" />
    <meta property="og:site_name" content="WebNav" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="DSTBP - WebNav" />
    <meta name="twitter:description" content="个人网址集" />
</head>

<body class="page-body">
    <!-- 页面容器 -->
    <div class="page-container">
        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 顶部导航栏 -->
            <nav class="navbar user-info-navbar" id="navbar" role="navigation">
                <ul class="user-info-menu left-links list-inline list-unstyled">
                    <li class="menu-item">
                        <a href="https://dstbp.net/" target="_black">
                            <i class="fa-solid fa-house"></i>
                            <span>主页</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="https://bgithub.xyz/DSTBP" target="_blank">
                            <i class="fa-brands fa-github"></i>
                            <span>GitHub</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="/url-checker.html" target="_blank">
                            <i class="fas fa-check-circle"></i>
                            <span>Check</span>
                        </a>
                    </li>
                    <!-- 设置按钮 -->
                    <li class="menu-item">
                        <a id="settings-btn" style="cursor: pointer;">
                            <i class="fa-solid fa-cog"></i>
                            <span>背景设置</span>
                        </a>
                    </li>
                    <!-- 夜间模式切换按钮 -->
                    <li class="menu-item night-mode-btn">
                        <a onclick="switchNightMode()" style="cursor: pointer;">
                            <i class="fa-solid fa-circle-half-stroke"></i>
                            <span>夜间模式</span>
                        </a>
                    </li>
                    <!-- 今日诗词 - 移动端隐藏 -->
                    <li class="menu-item desktop-only">
                        <i class="fa-solid fa-message" style="margin-right: 6px"></i>
                        <span id="jinrishici-sentence">正在加载今日诗词....</span>
                        <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
                    </li>
                </ul>
            </nav>

            <!-- 搜索框区域 -->
            <div id="search" class="s-search">
                <div id="search-list" class="hide-type-list">
                    <div class="s-type">
                        <span></span>
                        <div class="s-type-list animated fadeInUp">
                            <label for="type-site-search">常用</label>
                            <label for="type-search">搜索</label>
                            <label for="type-ping">工具</label>
                            <label for="type-zhihu">社区</label>
                            <label for="type-taobao1">生活</label>
                        </div>
                    </div>

                    <!-- 搜索分组：常用 -->
                    <div class="search-group group-a">
                        <span class="type-text">常用</span>
                        <ul class="search-type">
                            <li>
                                <input hidden type="radio" name="type" id="type-site-search"
                                    value="site-search" data-placeholder="站内搜索" /><label
                                    for="type-site-search"><span style="color: #008000" class="dark-text">站内搜索</span></label>
                            </li>
                            <li>
                                <input checked hidden type="radio" name="type" id="type-baidu"
                                    value="https://www.baidu.com/s?wd=" data-placeholder="百度一下，你就知道" /><label
                                    for="type-baidu"><span style="color: #2100e0" class="dark-text">百度</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-bing1"
                                    value="https://cn.bing.com/search?q=" data-placeholder="微软 Bing 搜索" /><label
                                    for="type-bing1"><span style="color: #007daa">Bing</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-google"
                                    value="https://www.google.com/search?q=" data-placeholder="谷歌搜索" /><label
                                    for="type-google"><span style="color: #3b83fa">G</span><span
                                        style="color: #f3442c">o</span><span style="color: #ffc300">o</span><span
                                        style="color: #4696f8">g</span><span style="color: #2cab4e">l</span><span
                                        style="color: #f54231">e</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-bili1"
                                    value="https://search.bilibili.com/all?keyword=" data-placeholder="哔哩哔哩搜索" /><label
                                    for="type-bili1"><span style="color: #00a1d6">BiliBili</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-git1"
                                    value="https://bgithub.xyz/search?utf8=%E2%9C%93&q="
                                    data-placeholder="搜索 Github 仓库" /><label for="type-git1"><span
                                        style="color: #1D2E47" class="dark-text">Github</span></label>
                            </li>
                        </ul>
                    </div>

                    <!-- 搜索分组：搜索 -->
                    <div class="search-group group-b">
                        <span class="type-text">搜索</span>
                        <ul class="search-type">
                            <li>
                                <input hidden type="radio" name="type" id="type-search"
                                    value="https://www.baidu.com/s?wd=" data-placeholder="百度一下，你就知道" /><label
                                    for="type-search"><span style="color: #2319dc" class="dark-text">百度</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-bing"
                                    value="https://cn.bing.com/search?q=" data-placeholder="微软 Bing 搜索" /><label
                                    for="type-bing"><span style="color: #007daa">Bing</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-google1"
                                    value="https://www.google.com/search?q=" data-placeholder="谷歌搜索" /><label
                                    for="type-google1"><span style="color: #3b83fa">G</span><span
                                        style="color: #f3442c">o</span><span style="color: #ffc300">o</span><span
                                        style="color: #4696f8">g</span><span style="color: #2cab4e">l</span><span
                                        style="color: #f54231">e</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-sogo"
                                    value="https://www.sogou.com/web?query=" data-placeholder="搜狗搜索" /><label
                                    for="type-sogo"><span style="color: #ff5943">搜狗</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-bili"
                                    value="https://search.bilibili.com/all?keyword="
                                    data-placeholder="bilibili 搜索" /><label for="type-bili"><span
                                        style="color: #00a1d6">BiliBili</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-git"
                                    value="https://bgithub.xyz/search?utf8=%E2%9C%93&q="
                                    data-placeholder="搜索 Github 仓库" /><label for="type-git"><span style="color: #000000"
                                        class="dark-text">Github</span></label>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- 搜索分组：工具 -->
                    <div class="search-group group-c">
                        <span class="type-text">工具</span>
                        <ul class="search-type">
                            <li>
                                <input hidden type="radio" name="type" id="type-ping" value="https://www.cesu.net/ping/"
                                    data-placeholder="只输 ip 地址" /><label for="type-ping"><span
                                        style="color: #00599e">PING检测</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-links" value="https://link.chinaz.com/"
                                    data-placeholder="请输入网址 ( 不带http:// )" /><label for="type-links"><span
                                        style="color: #7C44B6" class="dark-text">友链检测</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-https"
                                    value="https://stool.chinaz.com/https?url="
                                    data-placeholder="请输入网址 ( 不带http:// )" /><label for="type-https"><span
                                        style="color: #f00">HTTPS检测</span></label>
                            </li>
                        </ul>
                    </div>

                    <!-- 搜索分组：社区 -->
                    <div class="search-group group-d">
                        <span class="type-text">社区</span>
                        <ul class="search-type">
                            <li>
                                <input hidden type="radio" name="type" id="type-zhihu"
                                    value="https://www.zhihu.com/search?type=content&q="
                                    data-placeholder="知乎，与你分享刚编的故事" /><label for="type-zhihu"><span
                                        style="color: #0084ff">知乎</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-52pojie"
                                    value="https://www.52pojie.cn/search.php?mod=forum&searchid=11382&orderby=lastpost&ascdesc=desc&searchsubmit=yes&kw="
                                    data-placeholder="请输入搜索内容" /><label for="type-52pojie"><span
                                        style="color: #e21010">吾爱破解</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-kanxue"
                                    value="https://bbs.kanxue.com/search-" data-placeholder="社区关键词 回车搜索" /><label
                                    for="type-kanxue"><span style="color: #3cb0f1">看雪</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-stack"
                                    value="https://stackoverflow.com/search?q=" data-placeholder="Search..." /><label
                                    for="type-stack"><span style="color: #f48024">Stack Overflow</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-juejin"
                                    value="https://juejin.cn/search?query=" data-placeholder="探索稀土掘金" /><label
                                    for="type-juejin"><span style="color: #1e80ff">稀土掘金</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-csdn"
                                    value="https://juejin.cn/search?query=" data-placeholder="CSDN search" /><label
                                    for="type-csdn"><span style="color: #fb5430">CSDN</span></label>
                            </li>

                            <li>
                                <input hidden type="radio" name="type" id="type-douban"
                                    value="https://www.douban.com/search?q=" data-placeholder="豆瓣" /><label
                                    for="type-douban"><span style="color: #55a300">豆瓣</span></label>
                            </li>
                        </ul>
                    </div>

                    <!-- 搜索分组：生活 -->
                    <div class="search-group group-e">
                        <span class="type-text">生活</span>
                        <ul class="search-type">
                            <li>
                                <input hidden type="radio" name="type" id="type-taobao1"
                                    value="https://s.taobao.com/search?q=" data-placeholder="搜索宝贝" /><label
                                    for="type-taobao1"><span style="color: #f40">淘宝</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-jd"
                                    value="https://search.jd.com/Search?keyword=" data-placeholder="商品搜索" /><label
                                    for="type-jd"><span style="color: #c91623">京东</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-xiachufang"
                                    value="http://www.xiachufang.com/search/?keyword="
                                    data-placeholder="搜索菜谱、食材" /><label for="type-xiachufang"><span
                                        style="color: #dd3915">下厨房</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-xiangha"
                                    value="https://www.xiangha.com/so/?q=caipu&s=" data-placeholder="搜菜谱、食材" /><label
                                    for="type-xiangha"><span style="color: #930">香哈菜谱</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-xiaohongshu"
                                    value="https://www.xiaohongshu.com/search_result?keyword="
                                    data-placeholder="搜索小红书" /><label for="type-xiaohongshu"><span
                                        style="color: #ff1e3e">小红书</span></label>
                            </li>
                            <li>
                                <input hidden type="radio" name="type" id="type-douyin"
                                    value="https://www.douyin.com/search/" data-placeholder="搜索你感兴趣的内容" /><label
                                    for="type-douyin"><span style="color: #2e1a2d">抖音</span></label>
                            </li>
                            <!-- <li><input hidden type="radio" name="type" id="type-快递100" value="http://www.kuaidi100.com/?"
                                data-placeholder="快递100"><label for="type-快递100"><span style="color:#3278e6">快递100</span></label></li> -->
                        </ul>
                    </div>
                </div>

                <!-- 搜索表单 -->
                <form action="?s=" method="get" target="_blank" id="super-search-fm">
                    <input type="text" id="search-text" placeholder="输入关键字搜索" style="outline: 0"
                        autocomplete="off" /><button type="submit"><i class="fa fa-search"></i></button>
                </form>
                <!-- 在新标签页打开选项 -->
                <div class="set-check hidden-xs">
                    <input type="checkbox" id="set-search-blank" class="bubble-3" autocomplete="off" />
                </div>
            </div>

            <!-- 链接内容区 (将由JS动态生成) -->
            <div id="links-container"></div>
        </div>
    </div>

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" style="display:none;position:fixed;right:30px;bottom:40px;z-index:9999;width:48px;height:48px;border:none;border-radius:50%;background:#97D2F8;color:#fff;font-size:24px;box-shadow:0 2px 8px rgba(0,0,0,0.15);cursor:pointer;transition:background 0.3s;" title="返回顶部">
        <i class="fa fa-arrow-up"></i>
    </button>
    <script>
        /**
         * 切换夜间/日间模式
         */
        function switchNightMode() {
            const body = document.body;
            const isDark = body.classList.contains('dark-theme');
            if (isDark) {
                body.classList.remove('dark-theme');
                localStorage.setItem('darkMode', 'false');
                showModeToast('已切换为日间模式');
            } else {
                body.classList.add('dark-theme');
                localStorage.setItem('darkMode', 'true');
                showModeToast('已切换为夜间模式');
            }
        }

        /**
         * 显示模式切换提示
         * @param {string} msg - 要显示的消息
         */
        let toastInstance = null;
        function showModeToast(msg) {
            if (toastInstance) {
                iziToast.hide({}, toastInstance);
            }
            toastInstance = iziToast.success({
                title: msg,
                position: 'topRight',
                timeout: 1200
            });
        }

        /**
         * 页面加载完成后执行的主逻辑
         */
        document.addEventListener('DOMContentLoaded', function () {
            // 1. 初始化主题：页面加载时根据 localStorage 自动切换夜间/日间模式
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-theme');
            }

            // 2. 初始化设置面板功能
            const settingsBtn = document.getElementById('settings-btn');
            const mobileSettingsBtn = document.getElementById('mobile-settings-btn');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            const settingsPanel = document.getElementById('settings-panel');
            const settingsOverlay = document.getElementById('settings-overlay');

            // 桌面端设置按钮点击事件
            if (settingsBtn) {
                settingsBtn.addEventListener('click', function() {
                    settingsPanel.classList.add('is-visible');
                    settingsOverlay.classList.add('is-visible');
                });
            }

            // 手机端设置按钮点击事件
            if (mobileSettingsBtn) {
                mobileSettingsBtn.addEventListener('click', function() {
                    settingsPanel.classList.add('is-visible');
                    settingsOverlay.classList.add('is-visible');
                });
            }

            // 关闭设置面板
            if (closeSettingsBtn) {
                closeSettingsBtn.addEventListener('click', function() {
                    settingsPanel.classList.remove('is-visible');
                    settingsOverlay.classList.remove('is-visible');
                });
            }

            // 点击遮罩层关闭设置面板
            if (settingsOverlay) {
                settingsOverlay.addEventListener('click', function() {
                    settingsPanel.classList.remove('is-visible');
                    settingsOverlay.classList.remove('is-visible');
                });
            }

            // 3. 加载并渲染动态内容
            fetch('./data.json')
                .then(response => response.json())
                .then(data => {
                    // 动态生成链接内容区
                    const linksContainer = document.getElementById('links-container');
                    Object.entries(data.links).forEach(([category, items]) => {
                        const section = document.createElement('div');
                        section.innerHTML = `
                            <h4 class="text-gray">
                                <i class="fa-solid fa-tags" style="margin-right: 7px; color: rgb(194, 195, 199);" id="${category.replace(' ', '')}"></i><span class="category-color">${category}</span>
                            </h4>
                            <div class="row" id="${category}-links"></div>
                            <br/>`;
                        linksContainer.appendChild(section);
                        const row = document.getElementById(`${category}-links`);
                        items.forEach(item => {
                            const col = document.createElement('div');
                            const imageUrl = item.img.startsWith('http://') || item.img.startsWith('https://')? item.img: `./images/logos/${item.img}`;
                            col.className = 'col-sm-3';
                            col.innerHTML = `
                                <div class="xe-widget xe-conversations box2 label-info" 
                                    onclick="window.open('${item.url}', '_blank')" 
                                    data-toggle="tooltip" 
                                    data-placement="bottom" 
                                    title="${item.url}">
                                    <div class="xe-comment-entry">
                                        <a class="xe-user-img">
                                            <img data-src="${imageUrl}" 
                                                class="lozad img-circle" 
                                                width="40"
                                                src="./images/loading.svg" 
                                                alt="${item.name}" />
                                        </a>
                                        <div class="xe-comment">
                                            <a href="#" class="xe-user-name overflowClip_1">
                                                <strong>${item.name}</strong>
                                            </a>
                                            <p class="overflowClip_2">${item.desc}</p>
                                        </div>
                                    </div>
                                </div>`;
                            row.appendChild(col);
                        });
                    });

                    // 初始化图片懒加载
                    if (typeof lozad !== 'undefined') {
                        lozad('.lozad', { rootMargin: '200px 0px', threshold: 0.1 }).observe();
                    }

                    // 保存原始HTML，便于站内搜索后恢复
                    const originalLinksHTML = linksContainer.innerHTML;
                    const searchInput = document.getElementById('search-text');

                    // 站内搜索逻辑
                    searchInput.addEventListener('input', function () {
                        const keyword = this.value.trim().toLowerCase();
                        const type = document.querySelector('input[name="type"]:checked').value;
                        if (type !== 'site-search') return; // 只在站内搜索时生效
                        if (!keyword) {
                            // 无关键词时恢复原始分组
                            linksContainer.innerHTML = originalLinksHTML;
                        } else {
                            // 关键词过滤，收集所有匹配的卡片
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(originalLinksHTML, 'text/html');
                            const widgets = Array.from(doc.querySelectorAll('.xe-widget'));
                            const matched = widgets.filter(item => {
                                const name = item.querySelector('.xe-user-name strong').textContent.toLowerCase();
                                const desc = item.querySelector('.xe-comment p').textContent.toLowerCase();
                                return name.includes(keyword) || desc.includes(keyword);
                            });
                            // 只显示匹配项，重新排列
                            linksContainer.innerHTML = '';
                            const row = document.createElement('div');
                            row.className = 'row';
                            matched.forEach(item => {
                                const col = document.createElement('div');
                                col.className = 'col-sm-3';
                                col.innerHTML = item.outerHTML;
                                row.appendChild(col);
                            });
                            linksContainer.appendChild(row);
                        }
                        // 重新初始化图片懒加载
                        if (typeof lozad !== 'undefined') {
                            lozad('.lozad', { rootMargin: '200px 0px', threshold: 0.1 }).observe();
                        }
                    });

                    // 切换搜索类型时，清空输入框并恢复原始内容
                    document.querySelectorAll('input[name="type"]').forEach(input => {
                        input.addEventListener('change', function () {
                            if (document.querySelector('input[name="type"]:checked').value !== 'site-search') {
                                searchInput.value = '';
                                linksContainer.innerHTML = originalLinksHTML;
                                if (typeof lozad !== 'undefined') {
                                    lozad('.lozad', { rootMargin: '200px 0px', threshold: 0.1 }).observe();
                                }
                            }
                        });
                    });
                })
                .catch(error => console.error('数据加载失败:', error));

            // 返回顶部按钮逻辑
            const backToTopBtn = document.getElementById('back-to-top');
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = 'block';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    </script>

    <!-- 搜索功能脚本 -->
    <script src="./js/search.js"></script>
    <script src="./js/background.js"></script>

    <!-- 设置面板 -->
    <div id="settings-panel" class="settings-panel">
        <div class="settings-panel-header">
            <h4>背景设置</h4>
            <button id="close-settings-btn" class="close-btn">&times;</button>
        </div>
        <div class="settings-panel-body">
            <div class="setting-item">
                <label for="bg-image-url">自定义背景</label>
                <input type="text" id="bg-image-url" placeholder="输入图片 URL 或留空">
            </div>
            <div class="setting-item">
                <label for="bg-opacity-slider">内容区域不透明度: <span id="bg-opacity-value">90%</span></label>
                <input type="range" id="bg-opacity-slider" min="0.1" max="1" step="0.01" value="0.9">
            </div>
            <div class="setting-item">
                <button id="apply-bg-btn">应用背景 (留空则使用必应壁纸)</button>
            </div>
            <div class="setting-item">
                <button id="reset-bg-btn">恢复默认</button>
            </div>
        </div>
    </div>
    <div id="settings-overlay" class="settings-overlay"></div>
    <script src="sidebar.min.js"></script>
</body>

</html>
